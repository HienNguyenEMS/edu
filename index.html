
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduMan - Hệ thống Quản lý Trường học Toàn diện</title>

    <!-- Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <style>
        :root {
            --sidebar-width: 260px;
            --sidebar-collapsed-width: 72px; 
            --header-height: 70px;
            --sidebar-bg: #1c2b36; 
            --sidebar-header-bg: #131e28;
            --sidebar-link-color: #aeb9c2;
            --sidebar-link-hover-bg: #293d4e;
            --sidebar-link-active-bg: #0d6efd;
            --bs-primary-rgb: 13, 110, 253;
            --bs-body-font-family: 'Be Vietnam Pro', sans-serif;
            --bs-body-bg: #f8f9fc;
        }
        .wrapper { display: flex; width: 100%; align-items: stretch; }
        #content { width: 100%; min-height: 100vh; transition: margin-left 0.3s ease-in-out; }
        #sidebar { display: flex; flex-direction: column; background: var(--sidebar-bg); color: #fff; transition: all 0.3s ease-in-out; z-index: 1040; }
        #sidebar .sidebar-header { height: var(--header-height); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: var(--sidebar-header-bg); flex-shrink: 0; }
        #sidebar .logo-container { text-decoration: none; color: white; display: flex; align-items: center; overflow: hidden; }
        #sidebar .logo { height: 40px; flex-shrink: 0; }
        #sidebar .logo-text { margin-left: 10px; font-weight: 700; font-size: 1.5rem; white-space: nowrap; transition: opacity 0.2s, width 0.2s, margin-left 0.2s; }
        #sidebar .components { padding: 15px 0; flex-grow: 1; overflow-y: auto; }
        #sidebar .components a { padding: 12px 20px; font-size: 0.95rem; display: flex; align-items: center; color: var(--sidebar-link-color); border-left: 4px solid transparent; text-decoration: none; transition: all 0.2s ease; white-space: nowrap; }
        #sidebar .components a:hover { color: #fff; background: var(--sidebar-link-hover-bg); }
        #sidebar .components li.active > a { color: #fff; font-weight: 600; background: var(--sidebar-link-active-bg); border-left-color: #f8f9fa; }
        #sidebar .sidebar-heading { padding: 10px 20px; font-size: 0.75rem; color: #888; text-transform: uppercase; font-weight: 700; }
        #sidebar .fa-fw { font-size: 1.1rem; width: 30px; text-align: center; }
        #sidebar a[data-bs-toggle="collapse"] .collapse-icon { margin-left: auto; transition: transform 0.3s ease; font-size: 0.8rem; }
        #sidebar a[data-bs-toggle="collapse"][aria-expanded="true"] .collapse-icon { transform: rotate(-180deg); }
        #sidebar .collapse a { padding-left: calc(20px + 30px); font-size: 0.9rem; background: rgba(0,0,0,0.2); }
        .main-header { height: var(--header-height); display: flex; align-items: center; justify-content: space-between; padding: 0 1rem; background-color: #fff; border-bottom: 1px solid #e3e6f0; position: sticky; top: 0; z-index: 1020; }
        .main-content.active { animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1); border: 1px solid #e3e6f0; }
        .card-header { font-weight: 600; color: #343a40; background-color: #eef2f7; border-bottom: 1px solid #dee2e6; }
        .table > thead { background-color: #f3f6fc; vertical-align: middle; }
        .table > thead th { font-weight: 600; border-bottom-width: 1px !important; border-color: #e3e6f0 !important; }
        .kpi-card { border: 1px solid #e3e6f0; box-shadow: 0 0.1rem 0.5rem rgba(0,0,0,0.05); }
        .kpi-card .card-body { padding: 1rem; }
        #sidebar { position: fixed; top: 0; left: 0; height: 100vh; width: var(--sidebar-width); transform: translateX(-100%); }
        #sidebar.show { transform: translateX(0); }
        #sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1039; display: none; }
        #sidebar-overlay.active { display: block; }
        #content { margin-left: 0; }
        .nav-tabs-responsive { display: flex; flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .nav-tabs-responsive .nav-link { white-space: nowrap; }
        .chat-container .list-group-item { cursor: pointer; }
        .chat-body { height: 400px; overflow-y: auto; }
        .chat-message { margin-bottom: 1rem; }
        .chat-message.right { text-align: right; }
        .chat-message.right .message-content { background-color: var(--bs-primary); color: white; }
        .message-content { display: inline-block; padding: 0.5rem 1rem; border-radius: 1rem; max-width: 80%; }

        @media (min-width: 992px) {
            #sidebar { position: fixed; transform: translateX(0); }
            #sidebar-overlay { display: none !important; }
            #content { margin-left: var(--sidebar-width); }
            body.sidebar-collapsed #content { margin-left: var(--sidebar-collapsed-width); }
            body.sidebar-collapsed #sidebar { width: var(--sidebar-collapsed-width); }
            body.sidebar-collapsed #sidebar .logo-container { justify-content: center; }
            body.sidebar-collapsed #sidebar .logo-text,
            body.sidebar-collapsed #sidebar .nav-link span,
            body.sidebar-collapsed #sidebar .collapse-icon,
            body.sidebar-collapsed #sidebar .sidebar-heading { opacity: 0; width: 0; height: 0; overflow: hidden; margin: 0; padding: 0; }
            body.sidebar-collapsed #sidebar .nav-link { justify-content: center; padding-left: 10px; padding-right: 10px; }
            body.sidebar-collapsed #sidebar .fa-fw { margin-right: 0 !important; font-size: 1.5rem; }
            body.sidebar-collapsed #sidebar .collapse.show { display: none; }
        }
    </style>
</head>
<body>

<div id="sidebar-overlay"></div>
<div class="wrapper">
    <!-- === START: Sidebar === -->
    <nav id="sidebar">
        <div class="sidebar-header">
            <a href="#" class="logo-container nav-link" data-view="dashboard">
                <img src="https://cdn-icons-png.flaticon.com/512/2997/2997723.png" alt="Logo" class="logo">
                <span class="logo-text">EduMan</span>
            </a>
            <button class="btn btn-dark d-none d-lg-block" type="button" id="desktop-sidebar-toggle-btn"><i class="fas fa-bars"></i></button>
        </div>
        <ul class="list-unstyled components">
            <li class="active"><a href="#" class="nav-link" data-view="dashboard"><i class="fas fa-tachometer-alt fa-fw"></i><span>Tổng quan</span></a></li>
            
            <div class="sidebar-heading">Học vụ</div>
            <li>
                <a href="#studentSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-user-graduate fa-fw"></i><span>Học sinh</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="studentSubmenu">
                    <li><a href="#" class="nav-link" data-view="students"><span>Hồ sơ học sinh</span></a></li>
                    <li><a href="#" class="nav-link" data-view="discipline"><span>Khen thưởng & Kỷ luật</span></a></li>
                </ul>
            </li>
             <li>
                <a href="#classSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-chalkboard-teacher fa-fw"></i><span>Lớp học</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="classSubmenu">
                    <li><a href="#" class="nav-link" data-view="classes"><span>Danh sách Lớp</span></a></li>
                    <li><a href="#" class="nav-link" data-view="attendance"><span>Điểm danh</span></a></li>
                </ul>
            </li>

            <div class="sidebar-heading">Giảng dạy</div>
             <li>
                <a href="#teachingSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-book-reader fa-fw"></i><span>Giảng dạy</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="teachingSubmenu">
                    <li><a href="#" class="nav-link" data-view="timetable"><span>Thời khóa biểu</span></a></li>
                    <li><a href="#" class="nav-link" data-view="grades"><span>Học tập & Điểm số</span></a></li>
                    <li><a href="#" class="nav-link" data-view="teaching-log"><span>Sổ đầu bài điện tử</span></a></li>
                </ul>
            </li>

            <div class="sidebar-heading">Nội bộ</div>
             <li>
                <a href="#hrSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-users-cog fa-fw"></i><span>Nhân sự</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="hrSubmenu">
                    <li><a href="#" class="nav-link" data-view="teachers"><span>Hồ sơ CB-GV-NV</span></a></li>
                    <li><a href="#" class="nav-link" data-view="teacher-attendance"><span>Chấm công</span></a></li>
                    <li><a href="#" class="nav-link" data-view="leave"><span>Quản lý nghỉ phép</span></a></li>
                </ul>
            </li>
            <li>
                <a href="#financeSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-wallet fa-fw"></i><span>Tài chính</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="financeSubmenu">
                    <li><a href="#" class="nav-link" data-view="tuition"><span>Quản lý Học phí</span></a></li>
                    <li><a href="#" class="nav-link" data-view="finance-vouchers"><span>Các khoản Thu - Chi</span></a></li>
                </ul>
            </li>

            <div class="sidebar-heading">Tương tác</div>
             <li>
                <a href="#parentSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-comments fa-fw"></i><span>Phụ huynh</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="parentSubmenu">
                    <li><a href="#" class="nav-link" data-view="communication"><span>Sổ liên lạc điện tử</span></a></li>
                    <li><a href="#" class="nav-link" data-view="parent-corner"><span>Góc học tập PH</span></a></li>
                    <li><a href="#" class="nav-link" data-view="leave-requests"><span>Đơn xin nghỉ học</span></a></li>
                </ul>
            </li>
            
            <div class="sidebar-heading">Hệ thống</div>
            <li>
                <a href="#settingsSubmenu" data-bs-toggle="collapse" class="nav-link">
                    <i class="fas fa-cogs fa-fw"></i><span>Quản trị</span>
                    <i class="fas fa-chevron-down collapse-icon"></i>
                </a>
                <ul class="collapse list-unstyled" id="settingsSubmenu">
                    <li><a href="#" class="nav-link" data-view="announcements"><span>Thông báo chung</span></a></li>
                    <li><a href="#" class="nav-link" data-view="school-data"><span>Dữ liệu trường học</span></a></li>
                    <li><a href="#" class="nav-link" data-view="roles"><span>Phân quyền</span></a></li>
                    <li><a href="#" class="nav-link" data-view="user-guide"><span>Hướng dẫn sử dụng</span></a></li>
                </ul>
            </li>
        </ul>
    </nav>
    <!-- === END: Sidebar === -->

    <div id="content">
        <!-- === START: Header === -->
        <header class="main-header">
            <div class="d-flex align-items-center gap-2 w-100">
                <button class="btn border-0 d-lg-none" type="button" id="mobile-sidebar-toggle-btn"><i class="fas fa-bars fs-4"></i></button>
                <div class="input-group">
                    <span class="input-group-text bg-light border-0"><i class="fas fa-search"></i></span>
                    <input type="text" class="form-control bg-light border-0" id="global-search-input" placeholder="Tìm kiếm...">
                </div>
            </div>
            <div class="d-flex align-items-center flex-shrink-0 ms-3">
                 <div class="dropdown">
                    <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown"><i class="fas fa-bell fa-fw fs-4 text-secondary"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">4<span class="visually-hidden">unread</span></span></a>
                    <ul class="dropdown-menu dropdown-menu-end shadow border-0" style="width: 350px;">
                        <li class="dropdown-header">Thông báo mới</li>
                        <li><a class="dropdown-item d-flex align-items-start" href="#"><div class="me-3"><div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;"><i class="fas fa-file-alt"></i></div></div><div><div class="small text-muted">1 giờ trước</div><span class="fw-bold">PH HS Nguyễn An có phản hồi mới.</span></div></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item d-flex align-items-start" href="#"><div class="me-3"><div class="bg-warning text-dark rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;"><i class="fas fa-calendar-check"></i></div></div><div><div class="small text-muted">Hôm qua</div><span>Đã duyệt đơn nghỉ phép của GV Trần Văn Hùng.</span></div></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item d-flex align-items-start" href="#"><div class="me-3"><div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;"><i class="fas fa-money-bill-wave"></i></div></div><div><div class="small text-muted">08/07/2024</div><span>Hệ thống ghi nhận khoản thu học phí mới từ PH em Lê Thị Cẩm.</span></div></a></li>
                         <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item d-flex align-items-start" href="#"><div class="me-3"><div class="bg-info text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;"><i class="fas fa-bullhorn"></i></div></div><div><div class="small text-muted">07/07/2024</div><span>BGH đã đăng thông báo mới về lịch thi học kỳ.</span></div></a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-center small text-muted" href="#">Xem tất cả</a></li>
                    </ul>
                </div>
                <div class="dropdown ms-3">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                        <img src="https://i.pravatar.cc/40?u=admin" alt="Avatar" width="40" height="40" class="rounded-circle me-2">
                        <div><strong class="d-block">Cô Hiệu Trưởng</strong><small class="text-muted">BGH</small></div>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end shadow border-0">
                        <li><a class="dropdown-item nav-link-profile" data-view="my-profile" href="#"><i class="fas fa-user-circle fa-fw me-2"></i>Thông tin cá nhân</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt fa-fw me-2"></i>Đăng xuất</a></li>
                    </ul>
                </div>
            </div>
        </header>
        <!-- === END: Header === -->
        <main id="main-content-area" class="p-3 p-lg-4"></main>
    </div>
</div>

<!-- === START: Modals (All modals are here) === -->
<!-- Student Modal -->
<div class="modal fade" id="student-modal" tabindex="-1" aria-labelledby="studentModalLabel" aria-hidden="true"><div class="modal-dialog modal-xl modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="studentModalLabel">Hồ sơ Học sinh</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="student-form"><input type="hidden" name="id"><h6 class="text-primary">Thông tin học sinh</h6><hr class="mt-1"><div class="row g-3"><div class="col-md-4"><label class="form-label">Mã học sinh</label><input type="text" name="student_code" class="form-control" placeholder="Hệ thống tự tạo..." readonly></div><div class="col-md-4"><label class="form-label">Họ và tên</label><input type="text" name="full_name" class="form-control"></div><div class="col-md-4"><label class="form-label">Ngày sinh</label><input type="date" name="dob" class="form-control"></div><div class="col-md-3"><label class="form-label">Giới tính</label><select name="gender" class="form-select"><option value="Nam">Nam</option><option value="Nữ">Nữ</option></select></div><div class="col-md-3"><label class="form-label">Dân tộc</label><input type="text" name="ethnicity" class="form-control" value="Kinh"></div><div class="col-md-6"><label class="form-label">Nơi sinh</label><input type="text" name="birth_place" class="form-control"></div><div class="col-md-4"><label class="form-label">Đối tượng ưu tiên</label><select name="priority_group" class="form-select"><option>Không</option><option>Con thương binh</option></select></div><div class="col-md-4"><label class="form-label">Lớp</label><select name="class_id" class="form-select"><option>1A</option><option>6B</option><option>10A1</option><option>11B2</option><option>12A3</option></select></div><div class="col-md-4"><label class="form-label">Trạng thái</label><select name="status" class="form-select"><option value="Đang học">Đang học</option><option value="Thôi học">Thôi học</option><option value="Bảo lưu">Bảo lưu</option></select></div></div><h6 class="text-primary mt-4">Thông tin phụ huynh</h6><hr class="mt-1"><div class="row g-3"><div class="col-md-6"><label class="form-label">Họ tên Cha</label><input type="text" name="father_name" class="form-control"></div><div class="col-md-6"><label class="form-label">SĐT Cha</label><input type="tel" name="father_phone" class="form-control"></div><div class="col-md-6"><label class="form-label">Họ tên Mẹ</label><input type="text" name="mother_name" class="form-control"></div><div class="col-md-6"><label class="form-label">SĐT Mẹ</label><input type="tel" name="mother_phone" class="form-control"></div><div class="col-12"><label class="form-label">Địa chỉ thường trú</label><input type="text" name="address" class="form-control"></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>

<!-- Discipline Modal (for Students) -->
<div class="modal fade" id="discipline-modal" tabindex="-1" aria-labelledby="disciplineModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="disciplineModalLabel">Thêm/Sửa Khen thưởng - Kỷ luật (Học sinh)</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="discipline-form"><input type="hidden" name="id"><div class="row g-3"><div class="col-md-6"><label class="form-label">Học sinh</label><select name="student_name" class="form-select"><option>Nguyễn Văn An</option><option>Trần Thị Bình</option><option>Lê Minh Châu</option><option>Phạm Thị Dung</option></select></div><div class="col-md-6"><label class="form-label">Ngày quyết định</label><input type="date" name="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Phân loại</label><select name="type" class="form-select"><option value="Khen thưởng">Khen thưởng</option><option value="Kỷ luật">Kỷ luật</option></select></div><div class="col-md-6"><label class="form-label">Cấp quyết định</label><input type="text" name="decider" class="form-control" value="Ban Giám Hiệu"></div><div class="col-12"><label class="form-label">Nội dung chi tiết</label><textarea name="content" class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>

<!-- Teacher Discipline Modal (for Teachers) -->
<div class="modal fade" id="teacher-discipline-modal" tabindex="-1" aria-labelledby="teacherDisciplineModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="teacherDisciplineModalLabel">Thêm/Sửa Khen thưởng - Kỷ luật (Giáo viên)</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="teacher-discipline-form"><input type="hidden" name="id"><div class="row g-3"><div class="col-md-6"><label class="form-label">Ngày quyết định</label><input type="date" name="date" class="form-control"></div><div class="col-md-6"><label class="form-label">Số quyết định</label><input type="text" name="decision_no" class="form-control"></div><div class="col-12"><label class="form-label">Phân loại</label><select name="type" class="form-select"><option value="Khen thưởng">Khen thưởng</option><option value="Kỷ luật">Kỷ luật</option></select></div><div class="col-12"><label class="form-label">Nội dung chi tiết</label><textarea name="content" class="form-control" rows="3"></textarea></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>

<!-- Parent Feedback Modal -->
<div class="modal fade" id="feedback-modal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="feedbackModalLabel">Gửi Phản ánh / Góp ý</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="feedback-form"><div class="row g-3"><div class="col-12"><label class="form-label">Gửi đến</label><select name="recipient" class="form-select"><option>Ban Giám Hiệu</option><option>Phòng Tài vụ</option><option>Giáo viên chủ nhiệm lớp 10A1</option></select></div><div class="col-12"><label class="form-label">Tiêu đề</label><input type="text" name="title" class="form-control"></div><div class="col-12"><label class="form-label">Nội dung chi tiết</label><textarea name="content" class="form-control" rows="5"></textarea></div><div class="col-12"><label class="form-label">Đính kèm (nếu có)</label><input type="file" class="form-control"></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button><button type="button" class="btn btn-primary"><i class="fas fa-paper-plane me-2"></i>Gửi đi</button></div></div></div></div>

<!-- Class Modal -->
<div class="modal fade" id="class-modal" tabindex="-1" aria-labelledby="classModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="classModalLabel">Thông tin Lớp học</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><form id="class-form"><input type="hidden" name="id"><div class="row g-3"><div class="col-md-6"><label class="form-label">Tên Lớp</label><input type="text" name="class_name" class="form-control"></div><div class="col-md-6"><label class="form-label">Khối</label><select name="grade" class="form-select"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option></select></div><div class="col-md-6"><label class="form-label">Giáo viên chủ nhiệm</label><select name="teacher" class="form-select"><option>Nguyễn Thị Mai</option><option>Trần Văn Hùng</option><option>Lê Thị Thu</option><option>Phạm Văn An</option></select></div><div class="col-md-6"><label class="form-label">Năm học</label><select name="school_year" class="form-select"><option>2024-2025</option><option>2023-2024</option></select></div><div class="col-md-6"><label class="form-label">Sĩ số</label><input type="number" name="size" class="form-control"></div><div class="col-md-6"><label class="form-label">Trạng thái</label><select name="status" class="form-select"><option value="Đang hoạt động">Đang hoạt động</option><option value="Đã kết thúc">Đã kết thúc</option></select></div></div></form></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button><button type="button" class="btn btn-primary">Lưu</button></div></div></div></div>
<!-- === END: Modals === -->


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const mainContentArea = document.getElementById('main-content-area');
    const globalSearchInput = document.getElementById('global-search-input');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const desktopSidebarToggleBtn = document.getElementById('desktop-sidebar-toggle-btn');
    const mobileSidebarToggleBtn = document.getElementById('mobile-sidebar-toggle-btn');

    let chart1 = null, chart2 = null;
    let bsTooltipList = [];
    
    const searchPlaceholders = {
        dashboard: 'Tìm kiếm chung...', students: 'Tìm theo mã HS, tên, lớp...',
        grades: 'Tìm theo học sinh, lớp, môn học...', discipline: 'Tìm theo tên học sinh, loại vi phạm...',
        classes: 'Tìm kiếm lớp học...', attendance: 'Tìm kiếm điểm danh theo lớp, ngày...',
        timetable: 'Tìm kiếm theo lớp, giáo viên...', 'teaching-log': 'Tìm kiếm trong sổ đầu bài...',
        teachers: 'Tìm kiếm giáo viên theo tên, tổ...', 'teacher-attendance': 'Tìm kiếm chấm công GV...',
        leave: 'Tìm kiếm đơn nghỉ phép GV...', tuition: 'Tìm kiếm học sinh, trạng thái học phí...',
        'finance-vouchers': 'Tìm kiếm phiếu thu, chi...', communication: 'Tìm kiếm trao đổi, phụ huynh...',
        'leave-requests': 'Tìm kiếm đơn xin nghỉ của HS...', announcements: 'Tìm kiếm thông báo...',
        'school-data': 'Tìm kiếm dữ liệu trường học...', roles: 'Tìm kiếm vai trò...',
        'user-guide': 'Tìm kiếm hướng dẫn...', 'my-profile': 'Tìm kiếm trong thông tin cá nhân...',
        'parent-corner': 'Tìm kiếm thông tin học tập của con...',
    };
    
    // === START: All View Templates (Fully Populated and Corrected) ===
    const viewTemplates = {
        dashboard: `<div class="row"><div class="col-12"><div class="row"><div class="col-6 col-lg-3 mb-4"><div class="card kpi-card bg-primary-subtle border-primary h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Sĩ số Toàn trường</h6><h4 class="fw-bold mb-0">1,520</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card kpi-card bg-success-subtle border-success h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Học phí đã thu (tháng)</h6><h4 class="fw-bold mb-0">85%</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card kpi-card bg-info-subtle border-info h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Chuyên cần (Hôm nay)</h6><h4 class="fw-bold mb-0">98.5%</h4></div></div></div><div class="col-6 col-lg-3 mb-4"><div class="card kpi-card bg-warning-subtle border-warning h-100"><div class="card-body"><h6 class="text-muted small text-uppercase mb-2">Đơn nghỉ mới</h4><h4 class="fw-bold mb-0">3</h4></div></div></div></div></div><div class="col-lg-8 mb-4"><div class="card h-100"><div class="card-header">Học lực theo Khối (Học kỳ 1)</div><div class="card-body"><canvas id="performanceByGradeChart"></canvas></div></div></div><div class="col-lg-4 mb-4"><div class="card h-100"><div class="card-header">Tình hình Thu học phí</div><div class="card-body d-flex align-items-center justify-content-center"><div id="tuitionStatusChart" style="min-height: 300px; width:100%"></div></div></div></div></div>`,
        students: `<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2"><h3>Hồ sơ Học sinh</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#student-modal"><i class="fas fa-plus me-2"></i>Thêm học sinh</button></div><div class="card shadow-sm"><div class="card-header">Danh sách Học sinh</div><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã HS</th><th>Họ và Tên</th><th>Lớp</th><th>Ngày sinh</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody>
            <tr data-id="1" data-student_code="HS-001" data-full_name="Nguyễn Văn An" data-dob="2008-05-10" data-gender="Nam" data-class_id="10A1" data-status="Đang học" data-father_name="Nguyễn Văn B" data-father_phone="0909123456"><td>HS-001</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="student-detail">Nguyễn Văn An</a></td><td>10A1</td><td>10/05/2008</td><td><span class="badge bg-success">Đang học</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info nav-link" data-view="student-detail" title="Xem chi tiết"><i class="fas fa-eye"></i></button><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#student-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="2" data-student_code="HS-002" data-full_name="Trần Thị Bình" data-dob="2008-08-22" data-gender="Nữ" data-class_id="10A1" data-status="Đang học" data-mother_name="Trần Thị Mai" data-mother_phone="0912987654"><td>HS-002</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="student-detail">Trần Thị Bình</a></td><td>10A1</td><td>22/08/2008</td><td><span class="badge bg-success">Đang học</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info nav-link" data-view="student-detail" title="Xem chi tiết"><i class="fas fa-eye"></i></button><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#student-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="3" data-student_code="HS-003" data-full_name="Lê Minh Châu" data-dob="2007-01-01" data-gender="Nữ" data-class_id="11B2" data-status="Thôi học"><td>HS-003</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="student-detail">Lê Minh Châu</a></td><td>11B2</td><td>01/01/2007</td><td><span class="badge bg-danger">Thôi học</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info nav-link" data-view="student-detail" title="Xem chi tiết"><i class="fas fa-eye"></i></button><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#student-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="4" data-student_code="HS-004" data-full_name="Phạm Thị Dung" data-dob="2006-03-15" data-gender="Nữ" data-class_id="12A3" data-status="Bảo lưu"><td>HS-004</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="student-detail">Phạm Thị Dung</a></td><td>12A3</td><td>15/03/2006</td><td><span class="badge bg-info">Bảo lưu</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info nav-link" data-view="student-detail" title="Xem chi tiết"><i class="fas fa-eye"></i></button><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#student-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
        </tbody></table></div></div></div>`,
        discipline: `<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2"><h3>Khen thưởng & Kỷ luật (Học sinh)</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#discipline-modal"><i class="fas fa-plus me-2"></i>Thêm mới</button></div><div class="card shadow-sm"><div class="card-header">Danh sách Quyết định</div><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Ngày</th><th>Họ và Tên</th><th>Lớp</th><th>Phân loại</th><th>Nội dung</th><th class="text-center">Hành động</th></tr></thead><tbody>
            <tr data-id="1" data-student_name="Nguyễn Văn An" data-date="2024-05-20" data-type="Khen thưởng" data-content="Đạt giải Nhất HSG môn Toán cấp trường." data-decider="BGH"><td>20/05/2024</td><td>Nguyễn Văn An</td><td>10A1</td><td><span class="badge bg-success">Khen thưởng</span></td><td>Đạt giải Nhất HSG môn Toán cấp trường.</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#discipline-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="2" data-student_name="Trần Thị Bình" data-date="2024-03-15" data-type="Kỷ luật" data-content="Vi phạm nội quy, đi học muộn 3 lần." data-decider="GVCN"><td>15/03/2024</td><td>Trần Thị Bình</td><td>10A1</td><td><span class="badge bg-danger">Kỷ luật</span></td><td>Vi phạm nội quy, đi học muộn 3 lần.</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#discipline-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="3" data-student_name="Lê Minh Châu" data-date="2024-04-10" data-type="Kỷ luật" data-content="Nghỉ học không phép." data-decider="GVCN"><td>10/04/2024</td><td>Lê Minh Châu</td><td>11B2</td><td><span class="badge bg-danger">Kỷ luật</span></td><td>Nghỉ học không phép.</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#discipline-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="4" data-student_name="Phạm Thị Dung" data-date="2024-01-26" data-type="Khen thưởng" data-content="Tích cực tham gia phong trào văn nghệ." data-decider="Đoàn trường"><td>26/01/2024</td><td>Phạm Thị Dung</td><td>12A3</td><td><span class="badge bg-success">Khen thưởng</span></td><td>Tích cực tham gia phong trào văn nghệ.</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#discipline-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            </tbody></table></div></div></div>`,
        'student-detail': `<h3 class="mb-4">Hồ sơ chi tiết: Nguyễn Văn An</h3><div class="card mb-4"><div class="card-body"><div class="row align-items-center"><div class="col-md-2 text-center"><img src="https://i.pravatar.cc/150?u=student1" class="rounded-circle img-thumbnail"></div><div class="col-md-10"><p class="mb-1"><strong>Mã HS:</strong> HS-001</p><p class="mb-1"><strong>Lớp:</strong> 10A1 - <strong>GVCN:</strong> Cô Nguyễn Thị Mai</p><p class="mb-1"><strong>Ngày sinh:</strong> 10/05/2008 - <strong>Giới tính:</strong> Nam</p><p class="mb-0"><strong>Phụ huynh:</strong> Ông Nguyễn Văn B - <strong>SĐT:</strong> 0909123456</p></div></div></div></div><div class="card"><div class="card-body"><ul class="nav nav-tabs nav-tabs-responsive mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-class-history">Lịch sử Lớp học</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-attendance-history">Lịch sử Điểm danh</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-tuition-history">Lịch sử Học phí</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-achievements">Thành tích & Chứng nhận</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-class-history"><table class="table table-sm table-bordered"><thead><th>Năm học</th><th>Lớp</th><th>Kết quả</th><th>Hạnh kiểm</th></thead><tbody><tr><td>2023-2024</td><td>9A1</td><td>Giỏi</td><td>Tốt</td></tr><tr><td>2022-2023</td><td>8A1</td><td>Giỏi</td><td>Tốt</td></tr><tr><td>2021-2022</td><td>7A2</td><td>Khá</td><td>Tốt</td></tr><tr><td>2020-2021</td><td>6A2</td><td>Khá</td><td>Khá</td></tr></tbody></table></div><div class="tab-pane" id="tab-attendance-history"><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Trạng thái</th><th>Lý do</th></thead><tbody><tr><td>09/07/2024</td><td><span class="badge bg-danger">Vắng (P)</span></td><td>Nghỉ ốm</td></tr><tr><td>02/06/2024</td><td><span class="badge bg-warning text-dark">Đi muộn</span></td><td></td></tr><tr><td>15/05/2024</td><td><span class="badge bg-danger">Vắng (K)</span></td><td>GVCN đã liên hệ PH</td></tr><tr><td>10/04/2024</td><td><span class="badge bg-danger">Vắng (P)</span></td><td>Việc gia đình</td></tr></tbody></table></div><div class="tab-pane" id="tab-tuition-history"><table class="table table-sm table-bordered"><thead><th>Kỳ thu</th><th>Số tiền</th><th>Trạng thái</th><th>Ngày đóng</th></thead><tbody><tr><td>Học phí HK1 24-25</td><td>5,000,000đ</td><td><span class="badge bg-danger">Chưa đóng</span></td><td></td></tr><tr><td>Quỹ lớp HK1 24-25</td><td>500,000đ</td><td><span class="badge bg-success">Đã đóng</span></td><td>05/09/2024</td></tr><tr><td>Học phí HK2 23-24</td><td>4,500,000đ</td><td><span class="badge bg-success">Đã đóng</span></td><td>15/01/2024</td></tr><tr><td>BHYT 2024</td><td>850,000đ</td><td><span class="badge bg-success">Đã đóng</span></td><td>10/10/2023</td></tr></tbody></table></div><div class="tab-pane" id="tab-achievements"><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Loại</th><th>Nội dung</th></thead><tbody><tr><td>05/09/2024</td><td>Khen thưởng</td><td>HSG cấp Trường môn Toán</td></tr><tr><td>20/05/2024</td><td>Chứng nhận</td><td>Hoàn thành khóa học STEM</td></tr><tr><td>15/03/2024</td><td>Kỷ luật</td><td>Nhắc nhở vì mất trật tự</td></tr><tr><td>10/01/2024</td><td>Khen thưởng</td><td>Đạt giải Ba văn nghệ</td></tr></tbody></table></div></div></div></div>`,
        classes: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Danh sách Lớp học</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#class-modal"><i class="fas fa-plus me-2"></i>Thêm Lớp</button></div><div class="card"><div class="card-header">Lớp học năm 2024-2025</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Tên Lớp</th><th>Khối</th><th>GVCN</th><th class="text-center">Sĩ số</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody>
            <tr data-id="1" data-class_name="10A1" data-grade="10" data-teacher="Nguyễn Thị Mai" data-size="40" data-status="Đang hoạt động"><td>10A1</td><td>10</td><td>Nguyễn Thị Mai</td><td class="text-center">40</td><td><span class="badge bg-success">Đang hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#class-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="2" data-class_name="11B2" data-grade="11" data-teacher="Trần Văn Hùng" data-size="42" data-status="Đang hoạt động"><td>11B2</td><td>11</td><td>Trần Văn Hùng</td><td class="text-center">42</td><td><span class="badge bg-success">Đang hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#class-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="3" data-class_name="12A5" data-grade="12" data-teacher="Lê Thị Thu" data-size="38" data-status="Đang hoạt động"><td>12A5</td><td>12</td><td>Lê Thị Thu</td><td class="text-center">38</td><td><span class="badge bg-success">Đang hoạt động</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#class-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr data-id="4" data-class_name="9A1 (23-24)" data-grade="9" data-teacher="Phạm Văn An" data-size="45" data-status="Đã kết thúc"><td>9A1 (23-24)</td><td>9</td><td>Phạm Văn An</td><td class="text-center">45</td><td><span class="badge bg-secondary">Đã kết thúc</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#class-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
        </tbody></table></div></div></div>`,
        attendance: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Điểm danh</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#attendance-entry-modal"><i class="fas fa-plus me-2"></i>Điểm danh hôm nay</button></div><div class="card"><div class="card-header">Lịch sử điểm danh</div><div class="card-body"><div class="row g-3 mb-3"><div class="col-md-4"><input type="date" class="form-control" value="2024-07-11"></div><div class="col-md-4"><select class="form-select"><option>Tất cả lớp</option><option>10A1</option></select></div></div><div class="table-responsive"><table class="table table-hover"><thead><th>Ngày</th><th>Lớp</th><th class="text-center">Sĩ số</th><th class="text-center">Vắng</th><th class="text-center">Tỷ lệ</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>11/07/2024</td><td>10A1</td><td class="text-center">40</td><td class="text-center">1</td><td class="text-center">97.5%</td><td><span class="badge bg-success">Hoàn tất</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#attendance-entry-modal"><i class="fas fa-edit"></i> Sửa</button></td></tr><tr><td>11/07/2024</td><td>10A2</td><td class="text-center">42</td><td class="text-center">0</td><td class="text-center">100%</td><td><span class="badge bg-success">Hoàn tất</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#attendance-entry-modal"><i class="fas fa-edit"></i> Sửa</button></td></tr><tr><td>10/07/2024</td><td>10A1</td><td class="text-center">40</td><td class="text-center">2</td><td class="text-center">95.0%</td><td><span class="badge bg-success">Hoàn tất</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#attendance-entry-modal"><i class="fas fa-edit"></i> Sửa</button></td></tr><tr><td>10/07/2024</td><td>11B1</td><td class="text-center">38</td><td class="text-center">1</td><td class="text-center">97.4%</td><td><span class="badge bg-success">Hoàn tất</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#attendance-entry-modal"><i class="fas fa-edit"></i> Sửa</button></td></tr></tbody></table></div></div></div>`,
        timetable: `<h3 class="mb-4">Thời khóa biểu</h3><div class="card"><div class="card-body"><div class="d-flex justify-content-between align-items-center mb-3"><ul class="nav nav-pills"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#view-table">Bảng</a></li></ul><button class="btn btn-outline-primary"><i class="fas fa-upload me-2"></i>Nhập TKB từ file Excel</button></div><div class="tab-content"><div class="tab-pane active" id="view-table"><div class="table-responsive"><table class="table table-bordered text-center"><thead><tr><th>Tiết</th><th>Thứ 2</th><th>Thứ 3</th><th>Thứ 4</th><th>Thứ 5</th><th>Thứ 6</th><th>Thứ 7</th></tr></thead><tbody><tr><td>1</td><td>Toán</td><td>Lý</td><td>Văn</td><td>Hóa</td><td>Sử</td><td>GDCD</td></tr><tr><td>2</td><td>Toán</td><td>Lý</td><td>Văn</td><td>Hóa</td><td>Sử</td><td>GDQP</td></tr><tr><td>3</td><td>Anh</td><td>Sinh</td><td>Toán</td><td>Tin</td><td>Địa</td><td>SHL</td></tr><tr><td>4</td><td>Anh</td><td>Sinh</td><td>Toán</td><td>Tin</td><td>Địa</td><td>-</td></tr></tbody></table></div></div></div></div></div>`,
        grades: `<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2"><h3>Quản lý Học tập & Điểm số</h3></div><div class="card shadow-sm"><div class="card-header">Bảng điểm</div><div class="card-body"><div class="row g-3 mb-3 align-items-end"><div class="col-md-3"><label class="form-label">Lớp</label><select class="form-select"><option>10A1</option></select></div><div class="col-md-3"><label class="form-label">Môn học</label><select class="form-select"><option>Toán</option></select></div><div class="col-md-3"><label class="form-label">Học kỳ</label><select class="form-select"><option>Học kỳ 1</option></select></div><div class="col-md-3"><button class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#grade-modal"><i class="fas fa-edit me-2"></i>Nhập/Sửa điểm</button></div></div><div class="table-responsive"><table class="table table-bordered table-sm text-center"><thead><tr><th>STT</th><th class="text-start">Họ Tên</th><th>Miệng</th><th>15p</th><th>1 Tiết</th><th>HK</th><th>TBm</th></tr></thead><tbody><tr><td>1</td><td class="text-start">Nguyễn Văn An</td><td>9</td><td>8</td><td>8.5</td><td>9</td><td class="fw-bold">8.6</td></tr><tr><td>2</td><td class="text-start">Trần Thị Bình</td><td>8</td><td>7</td><td>7.5</td><td>8</td><td class="fw-bold">7.6</td></tr><tr><td>3</td><td class="text-start">Lê Thị Cẩm</td><td>10</td><td>9</td><td>9.5</td><td>9</td><td class="fw-bold">9.4</td></tr><tr><td>4</td><td class="text-start">Phạm Văn Dũng</td><td>7</td><td>6</td><td>5.5</td><td>6</td><td class="fw-bold text-danger">6.1</td></tr></tbody></table></div></div></div>`,
        'teaching-log': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Sổ đầu bài điện tử</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#teaching-log-modal"><i class="fas fa-plus me-2"></i>Ghi sổ</button></div><div class="card"><div class="card-header">Lịch sử ghi sổ đầu bài</div><div class="card-body"><div class="row g-3 mb-3"><div class="col-md-3"><input type="date" class="form-control"></div><div class="col-md-3"><select class="form-select"><option>Lớp 10A1</option></select></div><div class="col-md-3"><select class="form-select"><option>Tất cả GV</option></select></div></div><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Ngày</th><th>Tiết</th><th>Lớp</th><th>Môn</th><th>GV</th><th>Nội dung</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07</td><td>1</td><td>10A1</td><td>Toán</td><td>Nguyễn Thị Mai</td><td>Bài 1: Phương trình bậc hai</td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teaching-log-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>10/07</td><td>2</td><td>10A1</td><td>Lý</td><td>Trần Văn Hùng</td><td>Bài 2: Con lắc đơn</td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teaching-log-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>09/07</td><td>3</td><td>11B2</td><td>Hóa</td><td>Lê Thị Thu</td><td>Bài 3: Axit và Bazo</td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teaching-log-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>09/07</td><td>4</td><td>12A5</td><td>Văn</td><td>Phạm Văn An</td><td>Phân tích tác phẩm...</td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teaching-log-modal"><i class="fas fa-edit"></i></button></td></tr></tbody></table></div></div></div>`,
        teachers: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Hồ sơ Cán bộ - Giáo viên - Nhân viên</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#teacher-modal"><i class="fas fa-plus me-2"></i>Thêm mới</button></div><div class="card"><div class="card-header">Danh sách nhân sự</div><div class="card-body"><div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th>Mã NS</th><th>Họ và Tên</th><th>Phòng/Tổ</th><th>Chức vụ</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody>
            <tr><td>GV-001</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="teacher-detail">Nguyễn Thị Mai</a></td><td>Tổ Toán-Tin</td><td>Tổ trưởng</td><td><span class="badge bg-success">Đang công tác</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#teacher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr><td>GV-002</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="teacher-detail">Trần Văn Hùng</a></td><td>Tổ Lý-Hóa-Sinh</td><td>Giáo viên</td><td><span class="badge bg-success">Đang công tác</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#teacher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr><td>VP-001</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="teacher-detail">Lê Thị Thu</a></td><td>Văn phòng</td><td>Nhân viên</td><td><span class="badge bg-success">Đang công tác</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#teacher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            <tr><td>BGH-01</td><td><a href="#" class="nav-link p-0 fw-bold" data-view="teacher-detail">Phạm Văn An</a></td><td>Ban Giám Hiệu</td><td>Phó Hiệu trưởng</td><td><span class="badge bg-danger">Đã nghỉ hưu</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#teacher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr>
            </tbody></table></div></div></div>`,
        'teacher-detail': `<h3 class="mb-4">Hồ sơ chi tiết: Nguyễn Thị Mai</h3><div class="card mb-4"><div class="card-body"><div class="row align-items-center"><div class="col-md-2 text-center"><img src="https://i.pravatar.cc/150?u=teacher1" class="rounded-circle img-thumbnail"></div><div class="col-md-10"><p class="mb-1"><strong>Mã NS:</strong> GV-001</p><p class="mb-1"><strong>Chức vụ:</strong> Tổ trưởng - <strong>Tổ:</strong> Toán-Tin</p><p class="mb-1"><strong>Ngày vào làm:</strong> 15/08/2010 - <strong>Trình độ:</strong> Thạc sĩ</p><p class="mb-0"><strong>Email:</strong> maints@school.edu.vn - <strong>SĐT:</strong> 0987654321</p></div></div></div></div><div class="card"><div class="card-body"><ul class="nav nav-tabs nav-tabs-responsive mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-teaching-assignment">Phân công giảng dạy</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-work-history">Quá trình Công tác</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-teaching-assignment"><table class="table table-sm table-bordered"><thead><th>Năm học</th><th>Lớp</th><th>Môn học</th><th>Vai trò</th></thead><tbody><tr><td>2024-2025</td><td>10A1</td><td>Toán</td><td>GVCN</td></tr><tr><td>2024-2025</td><td>10A2</td><td>Toán</td><td>GV Bộ môn</td></tr><tr><td>2023-2024</td><td>9A1</td><td>Toán</td><td>GVCN</td></tr></tbody></table></div><div class="tab-pane" id="tab-work-history"><ul class="nav nav-pills mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-commendations">Khen thưởng</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-discipline-gv">Kỷ luật</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-commendations"><div class="d-flex justify-content-end mb-2"><button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#teacher-discipline-modal"><i class="fas fa-plus"></i> Thêm Khen thưởng</button></div><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Số QĐ</th><th>Nội dung</th><th>Hành động</th></thead><tbody><tr><td>20/11/2023</td><td>123/QĐ-KT</td><td>Đạt danh hiệu GVDG cấp Tỉnh</td><td class="text-center"><button class="btn btn-sm btn-outline-danger"><i class="fas fa-trash"></i></button></td></tr></tbody></table></div><div class="tab-pane" id="tab-discipline-gv"><div class="d-flex justify-content-end mb-2"><button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#teacher-discipline-modal"><i class="fas fa-plus"></i> Thêm Kỷ luật</button></div><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Số QĐ</th><th>Nội dung</th><th>Hành động</th></thead><tbody><tr><td colspan="4" class="text-center text-muted">Chưa có dữ liệu</td></tr></tbody></table></div></div></div></div></div></div>`,
        'teacher-attendance': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Chấm công GV-NV</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#teacher-attendance-modal"><i class="fas fa-plus me-2"></i>Chấm công thủ công</button></div><div class="card"><div class="card-header">Lịch sử chấm công</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Ngày</th><th>Nhân viên</th><th>Giờ vào</th><th>Giờ ra</th><th class="text-end">Tổng giờ</th><th>Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07/2024</td><td>Nguyễn Thị Mai</td><td>07:28</td><td>16:35</td><td class="text-end">8.1h</td><td><span class="badge bg-success">Đúng giờ</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teacher-attendance-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>10/07/2024</td><td>Trần Văn Hùng</td><td>07:40</td><td>16:32</td><td class="text-end">7.9h</td><td><span class="badge bg-warning text-dark">Đi muộn</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teacher-attendance-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>09/07/2024</td><td>Nguyễn Thị Mai</td><td>07:25</td><td>16:01</td><td class="text-end">7.6h</td><td><span class="badge bg-danger">Về sớm</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teacher-attendance-modal"><i class="fas fa-edit"></i></button></td></tr><tr><td>09/07/2024</td><td>Lê Thu An</td><td>07:30</td><td>16:30</td><td class="text-end">8.0h</td><td><span class="badge bg-success">Đúng giờ</span></td><td class="text-center"><button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#teacher-attendance-modal"><i class="fas fa-edit"></i></button></td></tr></tbody></table></div></div></div>`,
        leave: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Nghỉ phép (GV-NV)</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#leave-modal"><i class="fas fa-plus me-2"></i>Tạo đơn</button></div><div class="row mb-4"><div class="col-md-4"><div class="card text-center text-bg-primary h-100"><div class="card-header bg-transparent border-0 fw-bold">TỔNG PHÉP NĂM</div><div class="card-body fs-3 fw-bolder">12</div></div></div><div class="col-md-4"><div class="card text-center text-bg-warning h-100"><div class="card-header bg-transparent border-0 fw-bold">ĐÃ NGHỈ</div><div class="card-body fs-3 fw-bolder">4.5</div></div></div><div class="col-md-4"><div class="card text-center text-bg-success h-100"><div class="card-header bg-transparent border-0 fw-bold">CÒN LẠI</div><div class="card-body fs-3 fw-bolder">7.5</div></div></div></div><div class="card"><div class="card-header">Danh sách đơn nghỉ phép</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Người gửi</th><th>Phòng/Tổ</th><th>Từ ngày</th><th>Đến ngày</th><th>Lý do</th><th class="text-center">Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>Trần Văn Hùng</td><td>Tổ Lý-Hóa-Sinh</td><td>11/07/2024</td><td>12/07/2024</td><td>Việc gia đình</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ duyệt</span></td><td class="text-center"><div class="btn-group btn-group-sm" role="group"><button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-check"></i></button><ul class="dropdown-menu"><li><a class="dropdown-item" href="#">Duyệt</a></li><li><a class="dropdown-item" href="#">Từ chối</a></li></ul></div></td></tr><tr><td>Nguyễn Thị Mai</td><td>Tổ Toán-Tin</td><td>08/07/2024</td><td>08/07/2024</td><td>Nghỉ ốm</td><td class="text-center"><span class="badge bg-success">Đã duyệt</span></td><td class="text-center"></td></tr><tr><td>Lê Thị Thu</td><td>Văn phòng</td><td>15/07/2024</td><td>20/07/2024</td><td>Nghỉ phép năm</td><td class="text-center"><span class="badge bg-danger">Từ chối</span></td><td class="text-center"></td></tr><tr><td>Phạm Văn An</td><td>BGH</td><td>12/07/2024</td><td>12/07/2024</td><td>Đi công tác</td><td class="text-center"><span class="badge bg-info">Đã duyệt (BGH)</span></td><td class="text-center"></td></tr></tbody></table></div></div></div>`,
        tuition: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Học phí</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#tuition-modal"><i class="fas fa-plus me-2"></i>Tạo khoản thu mới</button></div><div class="card"><div class="card-header">Theo dõi thu học phí - Học kỳ 1 (2024-2025)</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Mã HS</th><th>Họ và Tên</th><th>Lớp</th><th class="text-end">Phải thu</th><th class="text-center">Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>HS-001</td><td>Nguyễn Văn An</td><td>10A1</td><td class="text-end">5,000,000đ</td><td class="text-center"><span class="badge bg-success">Đã đóng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info"><i class="fas fa-receipt"></i></button></div></td></tr><tr><td>HS-002</td><td>Trần Thị Bình</td><td>10A1</td><td class="text-end">5,000,000đ</td><td class="text-center"><span class="badge bg-danger">Chưa đóng</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning">Gửi nhắc nhở</button><button class="btn btn-outline-success">Xác nhận</button></div></td></tr><tr><td>HS-003</td><td>Lê Minh Châu</td><td>11B2</td><td class="text-end">5,200,000đ</td><td class="text-center"><span class="badge bg-warning text-dark">Đóng một phần</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning">Gửi nhắc nhở</button><button class="btn btn-outline-success">Xác nhận</button></div></td></tr><tr><td>HS-004</td><td>Phạm Thị Dung</td><td>12A3</td><td class="text-end">4,800,000đ</td><td class="text-center"><span class="badge bg-info">Miễn giảm</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info"><i class="fas fa-receipt"></i></button></div></td></tr></tbody></table></div></div></div>`,
        'finance-vouchers': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Thu - Chi</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#finance-voucher-modal"><i class="fas fa-plus me-2"></i>Tạo Phiếu</button></div><div class="card"><div class="card-body"><ul class="nav nav-tabs nav-tabs-responsive mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-receipts">Phiếu Thu</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-payments">Phiếu Chi</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-summary">Báo cáo tổng hợp</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-receipts"><div class="table-responsive"><table class="table table-hover"><thead><th>Ngày</th><th>Nội dung</th><th class="text-end">Số tiền</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07</td><td>Thu quỹ lớp 10A1</td><td class="text-end text-success">+ 2,000,000</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#finance-voucher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-payments"><div class="table-responsive"><table class="table table-hover"><thead><th>Ngày</th><th>Nội dung</th><th class="text-end">Số tiền</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>09/07</td><td>Chi mua văn phòng phẩm</td><td class="text-end text-danger">- 1,500,000</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning btn-edit" data-bs-toggle="modal" data-bs-target="#finance-voucher-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div><div class="tab-pane" id="tab-summary"><h5 class="mb-3">Tổng hợp trong kỳ</h5><div class="row"><div class="col-md-4"><div class="card text-center bg-success-subtle text-success-emphasis h-100"><div class="card-header bg-transparent border-0 fw-bold">TỔNG THU</div><div class="card-body fs-4 fw-bolder">32,000,000</div></div></div><div class="col-md-4"><div class="card text-center bg-danger-subtle text-danger-emphasis h-100"><div class="card-header bg-transparent border-0 fw-bold">TỔNG CHI</div><div class="card-body fs-4 fw-bolder">- 22,000,000</div></div></div><div class="col-md-4"><div class="card text-center bg-primary-subtle text-primary-emphasis h-100"><div class="card-header bg-transparent border-0 fw-bold">TỒN QUỸ</div><div class="card-body fs-4 fw-bolder">10,000,000</div></div></div></div></div></div></div></div>`,
        communication: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Sổ liên lạc điện tử</h3><div><button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#feedback-modal"><i class="fas fa-flag me-2"></i>Gửi phản ánh/góp ý</button> <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#communication-modal"><i class="fas fa-paper-plane me-2"></i>Gửi thông báo mới</button></div></div><div class="card chat-container"><div class="row g-0"><div class="col-12 col-lg-4 border-end"><div class="card-header">Danh sách hội thoại</div><div class="list-group list-group-flush"><a class="list-group-item list-group-item-action active"><div class="d-flex align-items-center"><img src="https://i.pravatar.cc/40?u=ph1" class="rounded-circle me-3" width="40"><div class="flex-grow-1"><div class="d-flex w-100 justify-content-between"><strong class="mb-1">PH em Nguyễn Văn An</strong><small class="text-muted">1 giờ</small></div><div class="small">Vâng cô, tôi đã nhận được thông tin...</div></div></div></a><a class="list-group-item list-group-item-action"><div class="d-flex align-items-center"><img src="https://i.pravatar.cc/40?u=ph2" class="rounded-circle me-3" width="40"><div class="flex-grow-1"><div class="d-flex w-100 justify-content-between"><strong class="mb-1">PH em Trần Thị Bình</strong><small class="text-muted">Hôm qua</small></div><div class="small">Cô ơi, gia đình xin phép cho cháu...</div></div></div></a><a class="list-group-item list-group-item-action"><div class="d-flex align-items-center"><img src="https://i.pravatar.cc/40?u=bgh" class="rounded-circle me-3" width="40"><div class="flex-grow-1"><div class="d-flex w-100 justify-content-between"><strong class="mb-1">Ban Giám Hiệu</strong><small class="text-muted">3 ngày</small></div><div class="small fw-bold">Thông báo về lịch thi cuối kỳ...</div></div></div></a></div></div><div class="col-12 col-lg-8"><div class="card-header d-flex align-items-center"><img src="https://i.pravatar.cc/40?u=ph1" class="rounded-circle me-3" width="40"><strong>PH em Nguyễn Văn An</strong></div><div class="card-body chat-body bg-light-subtle p-3"><div class="chat-message"><div class="message-content bg-white border">Chào cô, tôi là phụ huynh của em Nguyễn Văn An. Cô cho tôi hỏi về tình hình học tập của cháu tuần vừa rồi ạ.</div><div class="small text-muted mt-1">10:30, 10/07/2024</div></div><div class="chat-message right"><div class="message-content">Chào anh/chị, tuần vừa rồi cháu An học tốt, tiếp thu bài nhanh, chỉ cần chú ý hơn về chữ viết ạ.</div><div class="small text-muted mt-1">10:32, 10/07/2024</div></div><div class="chat-message"><div class="message-content bg-white border">Vâng cô, tôi đã nhận được thông tin. Cảm ơn cô nhiều ạ.</div><div class="small text-muted mt-1">11:15, 10/07/2024</div></div></div><div class="card-footer"><div class="input-group"><input type="text" class="form-control" placeholder="Nhập tin nhắn..."><button class="btn btn-primary"><i class="fas fa-paper-plane"></i></button></div></div></div></div></div>`,
        'parent-corner': `<h3 class="mb-4">Góc học tập: <span class="text-primary">Nguyễn Văn An (HS-001) - Lớp 10A1</span></h3><div class="card shadow-sm"><div class="card-body"><ul class="nav nav-tabs nav-tabs-responsive mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-overview-ph">Tổng quan</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-timetable-ph">Thời khóa biểu</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-attendance-ph">Điểm danh</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-grades-ph">Bảng điểm</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-discipline-ph">Khen thưởng/Kỷ luật</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-overview-ph"><h5>Thông báo & Cảnh báo nhanh</h5><div class="list-group"><a href="#" class="list-group-item list-group-item-action list-group-item-danger d-flex justify-content-between align-items-center">Học phí HK1 (5,000,000đ) đã quá hạn. <span class="badge bg-danger rounded-pill">!</span></a><a href="#" class="list-group-item list-group-item-action list-group-item-warning d-flex justify-content-between align-items-center">Điểm TB môn Lý (6.2đ) cần cải thiện. <span class="badge bg-warning rounded-pill">!</span></a><a href="#" class="list-group-item list-group-item-action list-group-item-info d-flex justify-content-between align-items-center">Nhà trường vừa có thông báo mới về lịch thi. <span class="badge bg-info rounded-pill">Mới</span></a></div><h5 class="mt-4">Sổ đầu bài (Hôm nay)</h5><table class="table table-sm table-bordered"><thead><th>Tiết</th><th>Môn</th><th>Nội dung</th><th>Dặn dò</th></thead><tbody><tr><td>1</td><td>Toán</td><td>Bài 1: Phương trình bậc hai</td><td>Làm BT 1,2,3 SGK/Tr.45</td></tr><tr><td>2</td><td>Lý</td><td>Bài 2: Con lắc đơn</td><td>Xem trước bài mới</td></tr></tbody></table></div><div class="tab-pane" id="tab-timetable-ph"><div class="table-responsive"><table class="table table-bordered text-center"><thead><tr><th>Tiết</th><th>Thứ 2</th><th>Thứ 3</th><th>Thứ 4</th><th>Thứ 5</th><th>Thứ 6</th><th>Thứ 7</th></tr></thead><tbody><tr><td>1</td><td>Toán</td><td>Lý</td><td>Văn</td><td>Hóa</td><td>Sử</td><td>GDCD</td></tr><tr><td>2</td><td>Toán</td><td>Lý</td><td>Văn</td><td>Hóa</td><td>Sử</td><td>GDQP</td></tr><tr><td>3</td><td>Anh</td><td>Sinh</td><td>Toán</td><td>Tin</td><td>Địa</td><td>SHL</td></tr><tr><td>4</td><td>Anh</td><td>Sinh</td><td>Toán</td><td>Tin</td><td>Địa</td><td>-</td></tr></tbody></table></div></div><div class="tab-pane" id="tab-attendance-ph"><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Trạng thái</th><th>Lý do</th></thead><tbody><tr><td>09/07/2024</td><td><span class="badge bg-danger">Vắng (P)</span></td><td>Nghỉ ốm</td></tr><tr><td>02/06/2024</td><td><span class="badge bg-warning text-dark">Đi muộn</span></td><td></td></tr><tr><td>15/05/2024</td><td><span class="badge bg-danger">Vắng (K)</span></td><td>GVCN đã liên hệ PH</td></tr><tr><td>10/04/2024</td><td><span class="badge bg-danger">Vắng (P)</span></td><td>Việc gia đình</td></tr></tbody></table></div><div class="tab-pane" id="tab-grades-ph"><div class="table-responsive"><table class="table table-bordered table-sm text-center"><thead><tr><th class="text-start">Môn học</th><th>Miệng</th><th>15p</th><th>1 Tiết</th><th>HK</th><th class="fw-bold">TBm</th></tr></thead><tbody><tr><td class="text-start">Toán</td><td>9</td><td>8</td><td>8.5</td><td>9</td><td class="fw-bold">8.6</td></tr><tr><td class="text-start">Ngữ Văn</td><td>8</td><td>7</td><td>7.5</td><td>8</td><td class="fw-bold">7.6</td></tr><tr><td class="text-start">Tiếng Anh</td><td>10</td><td>9</td><td>9.5</td><td>9</td><td class="fw-bold">9.4</td></tr><tr><td class="text-start">Vật Lý</td><td>7</td><td>6</td><td>5.5</td><td>6</td><td class="fw-bold text-danger">6.1</td></tr></tbody></table></div></div><div class="tab-pane" id="tab-discipline-ph"><table class="table table-sm table-bordered"><thead><th>Ngày</th><th>Loại</th><th>Nội dung</th><th>Cấp QĐ</th></tr></thead><tbody><tr><td>20/05/2024</td><td><span class="badge bg-success">Khen thưởng</span></td><td>Đạt giải Nhất HSG môn Toán cấp trường.</td><td>BGH</td></tr><tr><td>15/03/2024</td><td><span class="badge bg-danger">Kỷ luật</span></td><td>Nhắc nhở vì mất trật tự trong giờ học.</td><td>GVCN</td></tr></tbody></table></div></div></div></div>`,
        'leave-requests': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Quản lý Đơn xin nghỉ học</h3></div><div class="card"><div class="card-header">Danh sách đơn từ Phụ huynh</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Ngày gửi</th><th>Học sinh</th><th>Lớp</th><th>Ngày nghỉ</th><th class="text-center">Trạng thái</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07</td><td>Trần Thị Bình</td><td>10A1</td><td>11/07/2024</td><td class="text-center"><span class="badge bg-warning text-dark">Chờ duyệt</span></td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#leave-request-modal"><i class="fas fa-eye"></i></button><button class="btn btn-outline-success"><i class="fas fa-check"></i></button><button class="btn btn-outline-danger"><i class="fas fa-times"></i></button></div></td></tr><tr><td>08/07</td><td>Nguyễn Văn An</td><td>10A1</td><td>09/07/2024</td><td class="text-center"><span class="badge bg-success">Đã duyệt</span></td><td class="text-center"><button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#leave-request-modal"><i class="fas fa-eye"></i></button></td></tr><tr><td>07/07</td><td>Lê Minh Châu</td><td>11B2</td><td>08/07/2024</td><td class="text-center"><span class="badge bg-danger">Đã từ chối</span></td><td class="text-center"><button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#leave-request-modal"><i class="fas fa-eye"></i></button></td></tr></tbody></table></div></div></div>`,
        announcements: `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Thông báo chung</h3><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#announcement-modal"><i class="fas fa-plus me-2"></i>Tạo thông báo</button></div><div class="card"><div class="card-header">Danh sách thông báo</div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Ngày đăng</th><th>Tiêu đề</th><th>Đối tượng</th><th>Người tạo</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>10/07</td><td>Thông báo về lịch thi cuối kỳ</td><td>Toàn trường</td><td>BGH</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#announcement-modal"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div>`,
        'school-data': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Dữ liệu Trường học (Dữ liệu nguồn)</h3></div><div class="card"><div class="card-body"><ul class="nav nav-tabs nav-tabs-responsive mb-3"><li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-years">Năm học</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-subjects">Chương trình học</a></li><li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-departments">Tổ chuyên môn</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-years"><table class="table table-hover"><thead><th>Tên Năm học</th><th class="text-center">Hành động</th></tr></thead><tbody><tr><td>2024-2025</td><td class="text-center"><div class="btn-group btn-group-sm"><button class="btn btn-outline-warning"><i class="fas fa-edit"></i></button><button class="btn btn-outline-danger"><i class="fas fa-trash"></i></button></div></td></tr></tbody></table></div></div></div></div>`,
        roles: `<h3 class="mb-4">Phân quyền & Vai trò</h3><div class="row"><div class="col-md-4"><div class="card shadow-sm"><div class="card-header d-flex justify-content-between align-items-center"><span>Danh sách Vai trò</span><button class="btn btn-sm btn-primary"><i class="fas fa-plus"></i></button></div><div class="list-group list-group-flush"><a href="#" class="list-group-item list-group-item-action active">Ban Giám Hiệu</a><a href="#" class="list-group-item list-group-item-action">GV Chủ nhiệm</a><a href="#" class="list-group-item list-group-item-action">Kế toán</a><a href="#" class="list-group-item list-group-item-action">Phụ huynh</a></div></div></div><div class="col-md-8"><div class="card shadow-sm"><div class="card-header">Quyền cho vai trò: <strong class="text-primary">Ban Giám Hiệu</strong></div><div class="card-body"><div class="table-responsive"><table class="table table-sm table-bordered align-middle"><thead><tr><th>Module</th><th class="text-center">Xem</th><th class="text-center">Thêm</th><th class="text-center">Sửa</th><th class="text-center">Xóa</th><th class="text-center">Duyệt</th></tr></thead><tbody><tr><td>Hồ sơ Học sinh</td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center"><input class="form-check-input" type="checkbox" checked></td><td class="text-center">-</td></tr></tbody></table></div><div class="text-end mt-3"><button class="btn btn-primary"><i class="fas fa-save me-2"></i>Lưu thay đổi</button></div></div></div></div></div>`,
        'user-guide': `<div class="d-flex justify-content-between align-items-center mb-4"><h3>Hướng dẫn sử dụng</h3><button class="btn btn-primary"><i class="fas fa-plus me-2"></i>Thêm Hướng dẫn</button></div><div class="accordion" id="userGuideAccordion"><div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#guide-1">Làm thế nào để điểm danh?</button></h2><div id="guide-1" class="accordion-collapse collapse show"><div class="accordion-body"><p>...</p></div></div></div></div>`,
        'my-profile': `<h3 class="mb-4">Thông tin cá nhân</h3><div class="card shadow-sm"><div class="card-header">Thông tin tài khoản</div><div class="card-body"><div class="row g-4"><div class="col-md-4 text-center"><img src="https://i.pravatar.cc/150?u=admin" class="rounded-circle img-thumbnail mb-3" alt="Avatar"><input type="file" id="avatarUpload" class="d-none"><label for="avatarUpload" class="btn btn-outline-primary"><i class="fas fa-camera me-2"></i>Đổi ảnh đại diện</label></div><div class="col-md-8"><form><h5>Thông tin cơ bản</h5><div class="row g-3 mb-4"><div class="col-md-6"><label class="form-label">Họ và tên</label><input type="text" class="form-control" value="Cô Hiệu Trưởng"></div></div><h5>Đổi mật khẩu</h5><div class="row g-3"><div class="col-md-4"><label class="form-label">Mật khẩu cũ</label><input type="password" class="form-control"></div></div><div class="mt-4"><button type="submit" class="btn btn-success"><i class="fas fa-save me-2"></i>Lưu thay đổi</button></div></form></div></div></div></div>`,
    };
    // === END: All View Templates ===

    // === START: JS Functions ===
    function updateSidebarTooltips() {
        bsTooltipList.forEach(t => t.dispose());
        bsTooltipList = [];
        const isCollapsed = document.body.classList.contains('sidebar-collapsed');
        const links = sidebar.querySelectorAll('.components > li > a');
        if (isCollapsed) {
            links.forEach(link => {
                const title = link.querySelector('span')?.textContent;
                if (title) {
                    link.setAttribute('data-bs-toggle', 'tooltip');
                    link.setAttribute('data-bs-placement', 'right');
                    link.setAttribute('title', title);
                }
            });
            bsTooltipList = [...sidebar.querySelectorAll('[data-bs-toggle="tooltip"]')].map(el => new bootstrap.Tooltip(el));
        }
    }

    function renderView(viewId) {
        globalSearchInput.placeholder = searchPlaceholders[viewId] || 'Tìm kiếm...';
        mainContentArea.innerHTML = viewTemplates[viewId] || `<div class="p-5"><h3>Chức năng [${viewId}] đang được phát triển...</h3><p>Vui lòng quay lại sau.</p></div>`;
        mainContentArea.classList.add('active');
        setTimeout(() => mainContentArea.classList.remove('active'), 500);

        if (viewId === 'dashboard') {
            if (chart1) chart1.destroy();
            if (chart2) chart2.destroy();
            
            const perfChartEl = document.getElementById('performanceByGradeChart');
            if (perfChartEl) {
                chart1 = new Chart(perfChartEl.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['Khối 10', 'Khối 11', 'Khối 12'],
                        datasets: [
                            { label: 'Giỏi', data: [25, 30, 28], backgroundColor: 'rgba(40, 167, 69, 0.7)' },
                            { label: 'Khá', data: [45, 40, 42], backgroundColor: 'rgba(23, 162, 184, 0.7)' },
                            { label: 'TB', data: [20, 22, 18], backgroundColor: 'rgba(255, 193, 7, 0.7)' }
                        ]
                    },
                    options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true } } }
                });
            }

            const tuitionChartEl = document.getElementById('tuitionStatusChart');
            if (tuitionChartEl) {
                chart2 = new ApexCharts(tuitionChartEl, {
                    series: [85, 10, 5], chart: { type: 'donut', height: 320 },
                    labels: ['Đã thu', 'Chưa thu', 'Miễn giảm'],
                    colors: ['#28a745', '#dc3545', '#17a2b8'],
                    legend: { position: 'bottom' }
                });
                chart2.render();
            }
        }
        
        // Add interaction logic for the new communication view
        if (viewId === 'communication') {
            const conversationItems = mainContentArea.querySelectorAll('.list-group-item-action');
            conversationItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    conversationItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    // In a real app, you would now fetch and render the clicked conversation's details.
                });
            });
        }
    }
    
    function setActiveLink(targetLink) {
        document.querySelectorAll('#sidebar .components li').forEach(li => li.classList.remove('active'));
        if (targetLink) {
            const parentLi = targetLink.closest('li');
            if (parentLi) {
                parentLi.classList.add('active');
                const submenu = targetLink.closest('.collapse');
                if (submenu) {
                    const trigger = document.querySelector(`a[href="#${submenu.id}"]`);
                    if (trigger) {
                        trigger.closest('li').classList.add('active');
                        if (!submenu.classList.contains('show')) {
                            new bootstrap.Collapse(submenu).show();
                        }
                    }
                }
            }
        }
    }

    function toggleMobileSidebar() {
        sidebar.classList.toggle('show');
        sidebarOverlay.classList.toggle('active');
    }

    desktopSidebarToggleBtn.addEventListener('click', () => {
        document.body.classList.toggle('sidebar-collapsed');
        updateSidebarTooltips();
    });
    mobileSidebarToggleBtn.addEventListener('click', toggleMobileSidebar);
    sidebarOverlay.addEventListener('click', toggleMobileSidebar);

    document.body.addEventListener('click', (e) => {
        const link = e.target.closest('.nav-link, .nav-link-profile');
        if (link && link.dataset.view) {
            e.preventDefault();
            renderView(link.dataset.view);
            setActiveLink(link.closest('#sidebar .nav-link'));
            if (window.innerWidth < 992 && sidebar.classList.contains('show')) {
                toggleMobileSidebar();
            }
        }
    });

    // Event listener for all modals to handle "Add" and "Edit"
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget; // Button that triggered the modal
            const form = this.querySelector('form');
            if (!form) return;

            // If the button is an "edit" button, populate the form
            if (button && (button.classList.contains('btn-edit') || button.closest('.btn-edit'))) {
                const row = button.closest('tr');
                if (!row) return;

                const rowData = row.dataset;
                for (const key in rowData) {
                    const input = form.querySelector(`[name="${key}"]`);
                    if (input) {
                        input.value = rowData[key];
                    }
                }
            } else {
                // If it's an "add" button or a button without 'btn-edit', clear the form
                form.reset();
                const idInput = form.querySelector('[name="id"]');
                if(idInput) idInput.value = '';
            }
        });
    });

    // Initial Load
    renderView('dashboard');
    setActiveLink(document.querySelector(`#sidebar .nav-link[data-view="dashboard"]`));
    updateSidebarTooltips();
    // === END: JS Functions ===
});
</script>
</body>
</html>
